(base) root@7acc85289a76:/models/other_code/28TCM-Syndrome-and-Disease-Differentiation/02syndrome-bert# CUDA_VISIBLE_DEVICES=3 python train_bert_diease.py
python: can't open file '/models/other_code/28TCM-Syndrome-and-Disease-Differentiation/02syndrome-bert/train_bert_diease.py': [Errno 2] No such file or directory
(base) root@7acc85289a76:/models/other_code/28TCM-Syndrome-and-Disease-Differentiation/02syndrome-bert# CUDA_VISIBLE_DEVICES=3 python train_bert_syndrome.py
Loading /models/other_code/28TCM-Syndrome-and-Disease-Differentiation/data/train.json: 100%|██████████████████████████████████████████████| 720/720 [00:00<00:00, 1089822.76it/s]
Loading /models/other_code/28TCM-Syndrome-and-Disease-Differentiation/data/test.json: 100%|██████████████████████████████████████████████████| 80/80 [00:00<00:00, 914289.70it/s]
Loading /models/other_code/28TCM-Syndrome-and-Disease-Differentiation/data/test.json: 100%|██████████████████████████████████████████████████| 80/80 [00:00<00:00, 998643.81it/s]
Some weights of BertMultiLabelClassifier were not initialized from the model checkpoint at /models/models/tiansz/bert-base-chinese and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
{'eval_loss': 0.34998631477355957, 'eval_exact_match': 0.0, 'eval_hamming_loss': 0.11625, 'eval_precision_micro': 0.0, 'eval_recall_micro': 0.0, 'eval_f1_micro': 0.0, 'eval_precision_macro': 0.0, 'eval_recall_macro': 0.0, 'eval_f1_macro': 0.0, 'eval_runtime': 0.7774, 'eval_samples_per_second': 102.904, 'eval_steps_per_second': 6.431, 'epoch': 1.0}
{'eval_loss': 0.35028794407844543, 'eval_exact_match': 0.0625, 'eval_hamming_loss': 0.11375, 'eval_precision_micro': 0.625, 'eval_recall_micro': 0.053763440860215055, 'eval_f1_micro': 0.09900990099009901, 'eval_precision_macro': 0.0625, 'eval_recall_macro': 0.038461538461538464, 'eval_f1_macro': 0.047619047619047616, 'eval_runtime': 0.7764, 'eval_samples_per_second': 103.034, 'eval_steps_per_second': 6.44, 'epoch': 2.0}
{'eval_loss': 0.3363388478755951, 'eval_exact_match': 0.0, 'eval_hamming_loss': 0.11625, 'eval_precision_micro': 0.0, 'eval_recall_micro': 0.0, 'eval_f1_micro': 0.0, 'eval_precision_macro': 0.0, 'eval_recall_macro': 0.0, 'eval_f1_macro': 0.0, 'eval_runtime': 0.7818, 'eval_samples_per_second': 102.33, 'eval_steps_per_second': 6.396, 'epoch': 3.0}
{'eval_loss': 0.32813113927841187, 'eval_exact_match': 0.0625, 'eval_hamming_loss': 0.11375, 'eval_precision_micro': 0.625, 'eval_recall_micro': 0.053763440860215055, 'eval_f1_micro': 0.09900990099009901, 'eval_precision_macro': 0.0625, 'eval_recall_macro': 0.038461538461538464, 'eval_f1_macro': 0.047619047619047616, 'eval_runtime': 0.7814, 'eval_samples_per_second': 102.377, 'eval_steps_per_second': 6.399, 'epoch': 4.0}
{'eval_loss': 0.32499071955680847, 'eval_exact_match': 0.0625, 'eval_hamming_loss': 0.11375, 'eval_precision_micro': 0.625, 'eval_recall_micro': 0.053763440860215055, 'eval_f1_micro': 0.09900990099009901, 'eval_precision_macro': 0.0625, 'eval_recall_macro': 0.038461538461538464, 'eval_f1_macro': 0.047619047619047616, 'eval_runtime': 0.7837, 'eval_samples_per_second': 102.079, 'eval_steps_per_second': 6.38, 'epoch': 5.0}
{'eval_loss': 0.3270835876464844, 'eval_exact_match': 0.0125, 'eval_hamming_loss': 0.11875, 'eval_precision_micro': 0.25, 'eval_recall_micro': 0.010752688172043012, 'eval_f1_micro': 0.020618556701030927, 'eval_precision_macro': 0.025, 'eval_recall_macro': 0.007692307692307693, 'eval_f1_macro': 0.011764705882352941, 'eval_runtime': 0.7846, 'eval_samples_per_second': 101.968, 'eval_steps_per_second': 6.373, 'epoch': 6.0}
{'eval_loss': 0.317696750164032, 'eval_exact_match': 0.0625, 'eval_hamming_loss': 0.115, 'eval_precision_micro': 0.5555555555555556, 'eval_recall_micro': 0.053763440860215055, 'eval_f1_micro': 0.09803921568627451, 'eval_precision_macro': 0.05555555555555556, 'eval_recall_macro': 0.038461538461538464, 'eval_f1_macro': 0.045454545454545456, 'eval_runtime': 0.7827, 'eval_samples_per_second': 102.216, 'eval_steps_per_second': 6.389, 'epoch': 7.0}
{'eval_loss': 0.3233650326728821, 'eval_exact_match': 0.05, 'eval_hamming_loss': 0.12125, 'eval_precision_micro': 0.3333333333333333, 'eval_recall_micro': 0.043010752688172046, 'eval_f1_micro': 0.0761904761904762, 'eval_precision_macro': 0.04, 'eval_recall_macro': 0.03076923076923077, 'eval_f1_macro': 0.034782608695652174, 'eval_runtime': 0.7895, 'eval_samples_per_second': 101.328, 'eval_steps_per_second': 6.333, 'epoch': 8.0}
{'eval_loss': 0.3144565224647522, 'eval_exact_match': 0.05, 'eval_hamming_loss': 0.115, 'eval_precision_micro': 0.5714285714285714, 'eval_recall_micro': 0.043010752688172046, 'eval_f1_micro': 0.08, 'eval_precision_macro': 0.08, 'eval_recall_macro': 0.03076923076923077, 'eval_f1_macro': 0.04444444444444444, 'eval_runtime': 0.7774, 'eval_samples_per_second': 102.911, 'eval_steps_per_second': 6.432, 'epoch': 9.0}
{'eval_loss': 0.3205598294734955, 'eval_exact_match': 0.1, 'eval_hamming_loss': 0.12375, 'eval_precision_micro': 0.38461538461538464, 'eval_recall_micro': 0.10752688172043011, 'eval_f1_micro': 0.16806722689075632, 'eval_precision_macro': 0.3825, 'eval_recall_macro': 0.12226495726495726, 'eval_f1_macro': 0.14857142857142858, 'eval_runtime': 0.782, 'eval_samples_per_second': 102.301, 'eval_steps_per_second': 6.394, 'epoch': 10.0}
{'eval_loss': 0.3407996892929077, 'eval_exact_match': 0.125, 'eval_hamming_loss': 0.1225, 'eval_precision_micro': 0.41935483870967744, 'eval_recall_micro': 0.13978494623655913, 'eval_f1_micro': 0.20967741935483872, 'eval_precision_macro': 0.3, 'eval_recall_macro': 0.13553224553224555, 'eval_f1_macro': 0.1643001443001443, 'eval_runtime': 0.7791, 'eval_samples_per_second': 102.681, 'eval_steps_per_second': 6.418, 'epoch': 11.0}
{'loss': 0.3225, 'grad_norm': 1.4235090017318726, 'learning_rate': 2.2222222222222223e-05, 'epoch': 11.11}
{'eval_loss': 0.3339764475822449, 'eval_exact_match': 0.175, 'eval_hamming_loss': 0.115, 'eval_precision_micro': 0.5185185185185185, 'eval_recall_micro': 0.15053763440860216, 'eval_f1_micro': 0.23333333333333334, 'eval_precision_macro': 0.44333333333333336, 'eval_recall_macro': 0.14538073038073038, 'eval_f1_macro': 0.18942978590037413, 'eval_runtime': 0.7811, 'eval_samples_per_second': 102.425, 'eval_steps_per_second': 6.402, 'epoch': 12.0}
{'eval_loss': 0.3398682475090027, 'eval_exact_match': 0.1625, 'eval_hamming_loss': 0.13125, 'eval_precision_micro': 0.38, 'eval_recall_micro': 0.20430107526881722, 'eval_f1_micro': 0.26573426573426573, 'eval_precision_macro': 0.37318181818181817, 'eval_recall_macro': 0.2033061383061383, 'eval_f1_macro': 0.24780494015788132, 'eval_runtime': 0.7817, 'eval_samples_per_second': 102.341, 'eval_steps_per_second': 6.396, 'epoch': 13.0}
{'eval_loss': 0.35145482420921326, 'eval_exact_match': 0.1375, 'eval_hamming_loss': 0.13875, 'eval_precision_micro': 0.32, 'eval_recall_micro': 0.17204301075268819, 'eval_f1_micro': 0.22377622377622378, 'eval_precision_macro': 0.23583333333333334, 'eval_recall_macro': 0.15125485625485627, 'eval_f1_macro': 0.17748841801473378, 'eval_runtime': 0.7816, 'eval_samples_per_second': 102.352, 'eval_steps_per_second': 6.397, 'epoch': 14.0}
{'eval_loss': 0.35464781522750854, 'eval_exact_match': 0.225, 'eval_hamming_loss': 0.13, 'eval_precision_micro': 0.4, 'eval_recall_micro': 0.23655913978494625, 'eval_f1_micro': 0.2972972972972973, 'eval_precision_macro': 0.2928571428571428, 'eval_recall_macro': 0.2247047397047397, 'eval_f1_macro': 0.2380452468068567, 'eval_runtime': 0.7837, 'eval_samples_per_second': 102.075, 'eval_steps_per_second': 6.38, 'epoch': 15.0}
{'eval_loss': 0.3635500967502594, 'eval_exact_match': 0.1875, 'eval_hamming_loss': 0.1375, 'eval_precision_micro': 0.3559322033898305, 'eval_recall_micro': 0.22580645161290322, 'eval_f1_micro': 0.27631578947368424, 'eval_precision_macro': 0.2848412698412698, 'eval_recall_macro': 0.20812354312354314, 'eval_f1_macro': 0.2261490960020372, 'eval_runtime': 0.7861, 'eval_samples_per_second': 101.764, 'eval_steps_per_second': 6.36, 'epoch': 16.0}
{'eval_loss': 0.3725908398628235, 'eval_exact_match': 0.175, 'eval_hamming_loss': 0.145, 'eval_precision_micro': 0.3114754098360656, 'eval_recall_micro': 0.20430107526881722, 'eval_f1_micro': 0.24675324675324675, 'eval_precision_macro': 0.2848412698412698, 'eval_recall_macro': 0.20876456876456878, 'eval_f1_macro': 0.2306766917293233, 'eval_runtime': 0.785, 'eval_samples_per_second': 101.912, 'eval_steps_per_second': 6.37, 'epoch': 17.0}
{'eval_loss': 0.3741151690483093, 'eval_exact_match': 0.175, 'eval_hamming_loss': 0.14875, 'eval_precision_micro': 0.296875, 'eval_recall_micro': 0.20430107526881722, 'eval_f1_micro': 0.24203821656050956, 'eval_precision_macro': 0.23079365079365077, 'eval_recall_macro': 0.18792152292152292, 'eval_f1_macro': 0.1999920255183413, 'eval_runtime': 0.7918, 'eval_samples_per_second': 101.039, 'eval_steps_per_second': 6.315, 'epoch': 18.0}
{'eval_loss': 0.37704116106033325, 'eval_exact_match': 0.175, 'eval_hamming_loss': 0.145, 'eval_precision_micro': 0.31746031746031744, 'eval_recall_micro': 0.21505376344086022, 'eval_f1_micro': 0.2564102564102564, 'eval_precision_macro': 0.2576190476190476, 'eval_recall_macro': 0.20043123543123542, 'eval_f1_macro': 0.21637343332995504, 'eval_runtime': 0.784, 'eval_samples_per_second': 102.044, 'eval_steps_per_second': 6.378, 'epoch': 19.0}
{'eval_loss': 0.3781593441963196, 'eval_exact_match': 0.1875, 'eval_hamming_loss': 0.145, 'eval_precision_micro': 0.3230769230769231, 'eval_recall_micro': 0.22580645161290322, 'eval_f1_micro': 0.26582278481012656, 'eval_precision_macro': 0.26111111111111107, 'eval_recall_macro': 0.20812354312354314, 'eval_f1_macro': 0.22417617470249046, 'eval_runtime': 0.7832, 'eval_samples_per_second': 102.151, 'eval_steps_per_second': 6.384, 'epoch': 20.0}
{'train_runtime': 454.9163, 'train_samples_per_second': 31.654, 'train_steps_per_second': 1.978, 'train_loss': 0.24589958614773222, 'epoch': 20.0}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 900/900 [07:34<00:00,  1.98it/s]





